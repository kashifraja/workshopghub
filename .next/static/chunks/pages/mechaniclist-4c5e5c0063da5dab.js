(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[434],{791:(e,t,s)=>{"use strict";s.d(t,{N:()=>c});let c=(0,s(156).UU)("https://dnunrkkrsltywmtoyirj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRudW5ya2tyc2x0eXdtdG95aXJqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI2MDI5MDEsImV4cCI6MjA1ODE3ODkwMX0.a0zK7-4exPuoc1b9ykrMX0GeqsUwx1qATAOXiImrUqc")},2587:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var c=s(7876),i=s(4232),n=s(9099),a=s(791),l=s(9446);let r=()=>{let e=(0,n.useRouter)(),{user:t}=(0,l.J)();(0,i.useEffect)(()=>{t||e.push("/auth/login")},[t,e]);let[s,r]=(0,i.useState)(""),[o,h]=(0,i.useState)(""),[d,m]=(0,i.useState)(""),[u,p]=(0,i.useState)([]),[b,I]=(0,i.useState)(!0),[f,x]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{console.log("Fetching mechanics from Supabase...");try{let{data:e,error:t}=await a.N.from("mechanic").select("*");if(t)throw t;p(e)}catch(e){x("Failed to fetch mechanics"),console.error(e)}finally{I(!1)}})()},[]);let y=async e=>{try{let{error:t}=await a.N.from("mechanic").delete().eq("id",String(e));if(t)throw t;p(u.filter(t=>t.id!==e))}catch(e){x("Failed to delete mechanic: ".concat(e.message)),console.error(e)}};return b?(0,c.jsx)("p",{children:"Loading..."}):f?(0,c.jsx)("p",{children:f}):(0,c.jsxs)("div",{className:"container mt-5",children:[(0,c.jsx)("button",{onClick:()=>e.push("/"),className:"btn btn-secondary mb-4",children:"Home"}),(0,c.jsx)("h1",{children:"Mechanic Listings"}),(0,c.jsx)("button",{onClick:()=>e.push("/add-mechanic"),className:"btn btn-primary mb-4",children:"Add Mechanic"}),(0,c.jsx)("ul",{className:"list-group",children:u.map(e=>(0,c.jsxs)("li",{className:"list-group-item",children:[(0,c.jsx)("h5",{children:e.name}),(0,c.jsxs)("p",{children:["Commission: ",e.commission]}),(0,c.jsxs)("p",{children:["Specialty: ",e.specialty]}),(0,c.jsx)("button",{onClick:()=>{console.log("Attempting to delete mechanic with ID: ".concat(e.id)),y(e.id)},className:"btn btn-danger btn-sm",children:"Delete"})]},e.id))})]})}},4260:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/mechaniclist",function(){return s(2587)}])},9099:(e,t,s)=>{e.exports=s(8253)}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(4260)),_N_E=e.O()}]);