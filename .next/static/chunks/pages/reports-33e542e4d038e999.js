(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[769],{686:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports",function(){return s(3720)}])},1754:()=>{},2383:()=>{},3686:()=>{},3720:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(7876),a=s(4232),i=s(1040);s(1754);var l=s(8230),n=s.n(l),c=s(2770),d=s(9099),o=s(9446);let h=()=>{let e=(0,d.useRouter)(),{user:t}=(0,o.J)();(0,a.useEffect)(()=>{t||e.push("/auth/login")},[t,e]);let[s,l]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[x,p]=(0,a.useState)(0),[j,u]=(0,a.useState)(0),[b,N]=(0,a.useState)(0),[f,S]=(0,a.useState)(0),[g,_]=(0,a.useState)(0),[C,y]=(0,a.useState)(0),[P,v]=(0,a.useState)([]),[w,D]=(0,a.useState)(null),E=async()=>{let e=0,t=0,r=0,a=0;try{let l=(await i.A.get("/api/repairlist")).data.filter(e=>{let t=new Date(e.date);return t>=new Date(s)&&t<=new Date(h)});v(l),p(l.length),e=l.reduce((e,t)=>e+t.shopprofit,0),t=l.reduce((e,t)=>e+t.mechanicCommission,0),r=l.reduce((e,t)=>e+t.partsListPrice,0),a=l.reduce((e,t)=>e+t.partsCostPrice,0),u(l.reduce((e,t)=>e+t.total,0)),N(e),S(t),_(r),y(a)}catch(e){D(e.message)}},k=e=>{e.preventDefault(),E()};return(0,r.jsxs)("div",{className:"container mt-5",children:[(0,r.jsx)("h1",{className:"mb-4",style:{color:"black"},children:"ASIN Repair Report"}),(0,r.jsxs)("div",{className:"mb-4 d-flex",children:[(0,r.jsx)(n(),{href:"/",className:"btn btn-secondary me-2",children:"Home"})," ",(0,r.jsx)(n(),{href:"/repairlist",className:"btn btn-primary me-2",children:"Repair List"})," ",(0,r.jsx)("button",{type:"button",className:"btn btn-info me-2",onClick:()=>{let e=P.map(e=>({date:new Date(e.date).toLocaleDateString("en-US"),shopprofit:e.shopprofit,mechanicCommission:e.mechanicCommission,partsListPrice:e.partsListPrice,partsCostPrice:e.partsCostPrice})),t=c.Wp.json_to_sheet(e),s=c.Wp.book_new();c.Wp.book_append_sheet(s,t,"Reports"),c._h(s,"reports.xlsx")},children:"Export to Excel"})," ",(0,r.jsx)("button",{type:"submit",className:"btn btn-success",onClick:k,children:"Generate Report"})," "]}),(0,r.jsxs)("form",{onSubmit:k,children:[(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{className:"form-label",children:"Start Date:"}),(0,r.jsx)("input",{type:"date",value:s,onChange:e=>l(e.target.value),className:"form-control",required:!0})]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{className:"form-label",children:"End Date:"}),(0,r.jsx)("input",{type:"date",value:h,onChange:e=>m(e.target.value),className:"form-control",required:!0})]})]}),w&&(0,r.jsxs)("div",{className:"alert alert-danger mt-3",children:["Error: ",w]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h5",{children:"Filtered Records:"}),(0,r.jsxs)("table",{className:"table",children:[(0,r.jsx)("thead",{className:"table-header",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"table-primary",children:"Date"}),(0,r.jsx)("th",{className:"table-primary",children:"Shop Profit"}),(0,r.jsx)("th",{className:"table-primary",children:"Mechanic Commission"}),(0,r.jsx)("th",{className:"table-primary",children:"Parts List Price"}),(0,r.jsx)("th",{className:"table-primary",children:"Parts Cost Price"})]})}),(0,r.jsx)("tbody",{children:P.length>0?P.map((e,t)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:new Date(e.date).toLocaleDateString("en-US")}),(0,r.jsxs)("td",{children:["$",e.shopprofit.toFixed(2)]}),(0,r.jsxs)("td",{children:["$",e.mechanicCommission.toFixed(2)]}),(0,r.jsxs)("td",{children:["$",e.partsListPrice.toFixed(2)]}),(0,r.jsxs)("td",{children:["$",e.partsCostPrice.toFixed(2)]})]},t)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"5",children:"No records found for the selected date range."})})}),(0,r.jsx)("tfoot",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:"Totals:"})}),(0,r.jsx)("td",{children:(0,r.jsxs)("strong",{children:["$",b.toFixed(2)]})}),(0,r.jsx)("td",{children:(0,r.jsxs)("strong",{children:["$",f.toFixed(2)]})}),(0,r.jsx)("td",{children:(0,r.jsxs)("strong",{children:["$",g.toFixed(2)]})}),(0,r.jsx)("td",{children:(0,r.jsxs)("strong",{children:["$",C.toFixed(2)]})})]})})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[509,8,810,40,636,593,792],()=>t(686)),_N_E=e.O()}]);