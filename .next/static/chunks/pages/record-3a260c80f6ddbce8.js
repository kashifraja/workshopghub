(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295],{791:(e,s,a)=>{"use strict";a.d(s,{N:()=>l});let l=(0,a(156).UU)("https://dnunrkkrsltywmtoyirj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRudW5ya2tyc2x0eXdtdG95aXJqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI2MDI5MDEsImV4cCI6MjA1ODE3ODkwMX0.a0zK7-4exPuoc1b9ykrMX0GeqsUwx1qATAOXiImrUqc")},6e3:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/record",function(){return a(9632)}])},9099:(e,s,a)=>{e.exports=a(8253)},9632:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});var l=a(7876),r=a(4232),i=a(9099),c=a(791),n=a(1040),o=a(9446);let t=()=>{let e=(0,i.useRouter)(),{user:s}=(0,o.J)();(0,r.useEffect)(()=>{s||e.push("/auth/login")},[s,e]);let[a,t]=(0,r.useState)([]),[m,h]=(0,r.useState)([]),[d,u]=(0,r.useState)({date:"",vehicleName:"",namePlate:"",color:"",jobDescription:"",partsListPrice:0,partsCostPrice:0,shopLabor:0,mechanicLabor:0,paidBy:"",total:0,mechanicCommission:0,shopprofit:0,mechanic:""});(0,r.useEffect)(()=>{let e=async()=>{let{data:e,error:s}=await c.N.from("mechanic").select("*");if(s)throw s;h(e)};(async()=>{t((await n.A.get("/api/jobTypes")).data)})(),e(),u(e=>({...e,date:new Date().toISOString().split("T")[0]}))},[]);let b=e=>{let{name:s,value:a}=e.target,l=["partsListPrice","partsCostPrice","shopLabor","mechanicLabor"].includes(s)?Number(a):a;if(u(e=>({...e,[s]:l})),"mechanic"===s&&u(e=>({...e,mechanic:a,mechanicLabor:a?e.mechanicLabor:0})),"mechanic"===s){let e=m.find(e=>e.name===a),s=e?e.commission:0,l=Number(d.mechanicLabor)*s/100;u(e=>({...e,mechanicCommission:l}))}if("mechanicLabor"===s){let e=m.find(e=>e.name===d.mechanic),s=e?e.commission:0,l=Number(a)*s/100;u(e=>({...e,mechanicCommission:l}))}if(["shopLabor","partsListPrice","partsCostPrice"].includes(s)){let e=Number(d.partsListPrice)-Number(d.partsCostPrice)+Number(d.shopLabor);u(s=>({...s,shopprofit:e})),console.log("Updated Values:"),console.log("partsListPrice:",d.partsListPrice),console.log("partsCostPrice:",d.partsCostPrice),console.log("shopLabor:",d.shopLabor),console.log("Calculated shopProfit:",e)}},p=()=>{let{partsListPrice:e,shopLabor:s}=d,a=Number(e)+Number(s);u(e=>({...e,total:a}))},N=async s=>{s.preventDefault(),console.log("Submitting form data:",d);try{await n.A.post("/api/records",{...d,mechanicCommission:d.mechanicCommission}),e.push({pathname:"/",query:{message:"Record has been saved successfully!"}}),alert("Record has been saved successfully!")}catch(e){console.error("Error submitting form:",e)}};return(0,l.jsxs)("div",{className:"container mt-5",children:[(0,l.jsx)("h1",{className:"text-center",children:"ASIN Repair Record"}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("button",{className:"btn btn-secondary",onClick:()=>e.push("/"),children:"Home"}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>e.push("/repairlist"),children:"Repair List"})]}),(0,l.jsx)("input",{type:"hidden",name:"date",value:d.date})," ",(0,l.jsxs)("form",{onSubmit:N,className:"form",children:[(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Vehicle Name:"}),(0,l.jsx)("input",{type:"text",name:"vehicleName",onChange:b,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Name Plate:"}),(0,l.jsx)("input",{type:"text",name:"namePlate",onChange:b,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Color:"}),(0,l.jsx)("input",{type:"text",name:"color",onChange:b,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Job Description:"}),(0,l.jsx)("textarea",{name:"jobDescription",onChange:b,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Parts List Price:"}),(0,l.jsx)("input",{type:"number",name:"partsListPrice",onChange:b,onBlur:p,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Parts Cost Price:"}),(0,l.jsx)("input",{type:"number",name:"partsCostPrice",onChange:b,onBlur:p,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Job Type:"}),(0,l.jsxs)("select",{name:"jobType",onChange:b,required:!0,className:"form-select",children:[(0,l.jsx)("option",{value:"",children:"Select Job Type"}),a.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e._id))]})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Mechanic:"}),(0,l.jsxs)("select",{name:"mechanic",onChange:b,className:"form-select",children:[(0,l.jsx)("option",{value:"",children:"Select Mechanic"}),m.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e._id))]})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Shop Labor:"}),(0,l.jsx)("input",{type:"number",name:"shopLabor",onChange:b,onBlur:p,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Mechanic Labor:"}),(0,l.jsx)("input",{type:"number",name:"mechanicLabor",onChange:b,onBlur:p,required:!0,className:"form-control"})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Mechanic Commission:"}),(0,l.jsx)("input",{type:"number",value:d.mechanicCommission,readOnly:!0,className:"form-control",placeholder:"Mechanic Commission"})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Paid By:"}),(0,l.jsxs)("select",{name:"paidBy",onChange:b,required:!0,className:"form-select",children:[(0,l.jsx)("option",{value:"",children:"Select Payment Method"}),(0,l.jsx)("option",{value:"Credit Card",children:"Credit Card"}),(0,l.jsx)("option",{value:"Cash",children:"Cash"}),(0,l.jsx)("option",{value:"Zille",children:"Zille"}),(0,l.jsx)("option",{value:"Online Pay",children:"Online Pay"}),(0,l.jsx)("option",{value:"Cheque",children:"Cheque"}),(0,l.jsx)("option",{value:"Due",children:"Due"})]})]}),(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsx)("input",{type:"number",value:d.total,readOnly:!0,className:"form-control"})}),(0,l.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})," "]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[40,636,593,792],()=>s(6e3)),_N_E=e.O()}]);